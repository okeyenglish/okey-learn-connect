-- Create FAQ table for managing questions and answers
CREATE TABLE public.faq (
  id uuid NOT NULL DEFAULT gen_random_uuid() PRIMARY KEY,
  question text NOT NULL,
  answer text NOT NULL,
  sort_order integer DEFAULT 0,
  is_published boolean DEFAULT true,
  created_at timestamp with time zone NOT NULL DEFAULT now(),
  updated_at timestamp with time zone NOT NULL DEFAULT now()
);

-- Enable Row Level Security
ALTER TABLE public.faq ENABLE ROW LEVEL SECURITY;

-- Create policy for public reading of published FAQ items
CREATE POLICY "Allow public read access to published FAQ" 
ON public.faq 
FOR SELECT 
USING (is_published = true);

-- Create policy for service role to manage FAQ items
CREATE POLICY "Service role can manage FAQ items" 
ON public.faq 
FOR ALL 
USING (true)
WITH CHECK (true);

-- Create trigger for automatic timestamp updates
CREATE TRIGGER update_faq_updated_at
BEFORE UPDATE ON public.faq
FOR EACH ROW
EXECUTE FUNCTION public.update_updated_at_column();

-- Insert the current FAQ items
INSERT INTO public.faq (question, answer, sort_order) VALUES
('С какого возраста можно начать?', 'Дети — с 3 лет (игровые курсы), школьники и подростки — с программами по уровням CEFR, взрослые — с нуля до C2.', 1),
('Какие языки доступны?', 'Английский — основной. Также можно изучать испанский, итальянский, немецкий, французский, китайский и другие — уточните в филиале.', 2),
('Как выбрать уровень?', 'Пройдите онлайн-тест и посетите бесплатный пробный урок. Педагог диагностирует речь, грамматику и подскажет оптимальную группу.', 3),
('Что происходит на пробном уроке?', 'Знакомство с преподавателем, мини-диагностика и план обучения. По итогу — рекомендации по курсу и расписанию.', 4),
('Какие форматы обучения есть?', 'Группы, мини-группы и индивидуально. Очно в филиале и онлайн (можно комбинировать).', 5),
('Сколько человек в группе?', 'Обычно 6–10 человек (мини-группы 3–5). Точные цифры зависят от направления и филиала.', 6),
('Сколько длится занятие и как часто они идут?', 'Дети — 45–60 минут, подростки и взрослые — 60–90 минут. Частота 1–3 раза в неделю — подбираем под цель и нагрузку.', 7),
('Что, если ребёнок пропустил урок?', 'Дадим конспект/материалы, подскажем, как наверстать. Возможны отработки в разговорном клубе или индивидуально.', 8),
('Есть ли домашние задания?', 'Да, в разумном объёме. Для дошкольников — в игровой форме. Для школьников — регулярная практика для прочного результата.', 9),
('Кто преподаёт?', 'Опытные преподаватели и носители языка. Используем современные методики и материалы (в т.ч. Cambridge).', 10),
('По каким уровням учитесь?', 'По CEFR: A1–C2. Детские курсы — Super Safari, Kid''s Box; школьники — Prepare; взрослые — Empower и др.', 11),
('Готовите к экзаменам?', 'Да. ОГЭ/ЕГЭ и международные — Cambridge Exams, IELTS, TOEFL. Поможем выбрать формат и срок подготовки.', 12),
('Как вы измеряете прогресс?', 'Стартовая диагностика, промежуточные срезы и отчёт педагога. Если прогресс замедляется — корректируем программу и даём доп.поддержку.', 13),
('Сколько стоит обучение и как оплатить?', 'Цена зависит от формата и длительности. Доступна помесячная оплата и безнал. Актуальные тарифы — на странице «Стоимость».', 14),
('Можно ли оплатить материнским капиталом?', 'Да, в O''KEY ENGLISH можно оплачивать обучение материнским капиталом. Менеджер поможет оформить документы.', 15),
('Можно ли сменить формат или филиал?', 'Да. Можно перейти в онлайн/оффлайн или на другой адрес школы — подберём удобную группу по уровню и расписанию.', 16),
('Материалы включены в стоимость?', 'Используем современные учебники и онлайн-платформы. По курсам материалы могут входить в стоимость или оплачиваться отдельно — подскажем при записи.', 17),
('Есть ли занятия в каникулы и праздники?', 'График меняется по филиалам. Мы заранее уведомляем о переносах и предлагаем альтернативные даты.', 18),
('Подходит ли обучение детям с особыми образовательными потребностями?', 'Мы стараемся адаптировать формат и темп. Сообщите менеджеру детали — предложим индивидуальный план.', 19),
('Как записаться на пробный урок?', 'Нажмите «Записаться на пробный урок», напишите в WhatsApp/Telegram или позвоните — согласуем удобное время.', 20);