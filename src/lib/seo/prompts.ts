import { branches } from '@/lib/branches';

/**
 * –ü—Ä–æ–º–ø—Ç –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–¥–µ–π –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–ª–∞—Å—Ç–µ—Ä–∞ –∑–∞–ø—Ä–æ—Å–æ–≤
 */
export const SCHOOL_IDEAS_PROMPT = (
  head: string,
  intent: string,
  phrases: string[],
  existingPages: string[]
) => `
–¢—ã ‚Äî SEO-—Å—Ç—Ä–∞—Ç–µ–≥ —à–∫–æ–ª—ã –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ —è–∑—ã–∫–∞ O'KEY ENGLISH.

–§–ò–õ–ò–ê–õ–´: ${branches.map(b => `${b.name} (${b.metro})`).join(', ')}

–ö–õ–ê–°–¢–ï–†: "${head}"
–ò–ù–¢–ï–ù–¢: ${intent}
–ö–õ–Æ–ß–ï–í–´–ï –§–†–ê–ó–´ (—Ç–æ–ø-50): ${phrases.slice(0, 50).join(', ')}

–°–£–©–ï–°–¢–í–£–Æ–©–ò–ï –°–¢–†–ê–ù–ò–¶–´ (–Ω–µ –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å):
${existingPages.slice(0, 50).join('\n')}

–ó–ê–î–ê–ß–ê: –ü—Ä–µ–¥–ª–æ–∂–∏ 3-5 –∏–¥–µ–π –∫–æ–Ω—Ç–µ–Ω—Ç–∞, –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞—Å–∫—Ä–æ—é—Ç –∫–ª–∞—Å—Ç–µ—Ä –ë–ï–ó –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è.

–¢–ò–ü–´ —Å—Ç—Ä–∞–Ω–∏—Ü:
- **article**: –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è —Å—Ç–∞—Ç—å—è (–º–µ—Ç–æ–¥–∏–∫–∏, —Å–æ–≤–µ—Ç—ã, –≥–∞–π–¥—ã)
- **landing**: –ü—Ä–æ–¥–∞—é—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ (–∫–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞/–∫—É—Ä—Å)
- **local**: –õ–æ–∫–∞–ª—å–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Ñ–∏–ª–∏–∞–ª–∞ —Å –≥–µ–æ-–ø—Ä–∏–≤—è–∑–∫–æ–π
- **faq**: –ü–æ–¥—Ä–æ–±–Ω—ã–π FAQ –ø–æ —Ç–µ–º–µ
- **compare**: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º/—Ñ–æ—Ä–º–∞—Ç–æ–≤/–≤–æ–∑—Ä–∞—Å—Ç–æ–≤
- **hub**: –ê–≥—Ä–µ–≥–∞—Ç–æ—Ä/–∫–∞—Ç–∞–ª–æ–≥ (—Å–≤–æ–¥–∫–∞ –∫—É—Ä—Å–æ–≤ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏)

–î–õ–Ø LOCAL-—Ç–∏–ø–∞:
- –°–æ–∑–¥–∞–π –≤–∞—Ä–∏–∞–Ω—Ç—ã –¢–û–õ–¨–ö–û –¥–ª—è —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —Ñ–∏–ª–∏–∞–ª–æ–≤ (–Ω–µ –¥–ª—è –≤—Å–µ—Ö 9!)
- –£—á—Ç–∏ —Å–ø–µ—Ü–∏—Ñ–∏–∫—É –ª–æ–∫–∞—Ü–∏–∏: –º–µ—Ç—Ä–æ, —Ä–∞–π–æ–Ω, —Å–æ—Å–µ–¥–Ω–∏–µ —Ä–∞–π–æ–Ω—ã
- URL —Ñ–æ—Ä–º–∞—Ç: /branches/{branch_id}/{—Ç–µ–º–∞}
- –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ: –∞–¥—Ä–µ—Å, –º–µ—Ç—Ä–æ, —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ, –∫–æ–Ω—Ç–∞–∫—Ç—ã —Ñ–∏–ª–∏–∞–ª–∞
- –£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å: —Ä–∞–∑–Ω—ã–µ –∫–µ–π—Å—ã/–ø—Ä–∏–º–µ—Ä—ã/–æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–∏–ª–∏–∞–ª–∞

–§–û–†–ú–ê–¢ –û–¢–í–ï–¢–ê (—Å—Ç—Ä–æ–≥–æ JSON):
[
  {
    "type": "article" | "landing" | "local" | "faq" | "compare" | "hub",
    "title": "SEO-–∑–∞–≥–æ–ª–æ–≤–æ–∫ –¥–æ 60 —Å–∏–º–≤–æ–ª–æ–≤ —Å –∫–ª—é—á–æ–º",
    "h1": "–ì–ª–∞–≤–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã",
    "route": "/–ø—É—Ç—å-–∫-—Å—Ç—Ä–∞–Ω–∏—Ü–µ",
    "branch": null | "kotelniki" | "novokosino" | ...,
    "meta": {
      "description": "–ú–µ—Ç–∞-–æ–ø–∏—Å–∞–Ω–∏–µ –¥–æ 160 —Å–∏–º–≤–æ–ª–æ–≤",
      "keywords": ["–∫–ª—é—á1", "–∫–ª—é—á2", "–∫–ª—é—á3"]
    },
    "outline": [
      {"level": "h2", "heading": "–ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å–µ–∫—Ü–∏–∏"},
      {"level": "h3", "heading": "–ü–æ–¥—Å–µ–∫—Ü–∏—è"}
    ],
    "internalLinks": [
      {"anchor": "–ø—Ä–æ–≥—Ä–∞–º–º–∞ Super Safari", "url": "/programs/super-safari"},
      {"anchor": "—Ü–µ–Ω—ã –Ω–∞ –æ–±—É—á–µ–Ω–∏–µ", "url": "/pricing"}
    ],
    "faqPreview": [
      {"q": "–í–æ–ø—Ä–æ—Å?", "a": "–ö—Ä–∞—Ç–∫–∏–π –æ—Ç–≤–µ—Ç"}
    ],
    "schema": "Article" | "FAQPage" | "LocalBusiness"
  }
]

–¢–†–ï–ë–û–í–ê–ù–ò–Ø:
- –ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —è–∑—ã–∫, –ë–ï–ó –ø–µ—Ä–µ–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ URL (–ø—Ä–æ–≤–µ—Ä—å –ø—Ä–æ—Ç–∏–≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö!)
- –î–ª—è –ª–æ–∫–∞–ª—å–Ω—ã—Ö: —Ä–∞–∑–Ω—ã–µ —É–≥–ª—ã/—Ñ–æ–∫—É—Å—ã –ø–æ —Ñ–∏–ª–∏–∞–ª–∞–º
- –ú–∏–Ω–∏–º—É–º 3 –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- CTA –≤ –∫–∞–∂–¥–æ–π –∏–¥–µ–µ

–û—Ç–≤–µ—Ç –¢–û–õ–¨–ö–û JSON-–º–∞—Å—Å–∏–≤, –±–µ–∑ –æ–±–µ—Ä—Ç–∫–∏ \`\`\`json.
`;

/**
 * –ü—Ä–æ–º–ø—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –¢–ó –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏–¥–µ–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
 */
export const SCHOOL_BRIEF_PROMPT = (
  idea: any,
  existingPages: string[],
  similarContent: string[]
) => `
–¢—ã ‚Äî –≥–ª–∞–≤–Ω—ã–π —Ä–µ–¥–∞–∫—Ç–æ—Ä O'KEY ENGLISH SCHOOL.

–ò–î–ï–Ø –ö–û–ù–¢–ï–ù–¢–ê:
${JSON.stringify(idea, null, 2)}

–°–£–©–ï–°–¢–í–£–Æ–©–ò–ï –°–¢–†–ê–ù–ò–¶–´ –î–õ–Ø –°–°–´–õ–û–ö:
${existingPages.slice(0, 30).join(', ')}

–ü–û–•–û–ñ–ò–ô –ö–û–ù–¢–ï–ù–¢ (–∏–∑–±–µ–≥–∞–π –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è):
${similarContent.slice(0, 3).join('\n---\n')}

–ó–ê–î–ê–ß–ê: –°–æ–∑–¥–∞–π –¥–µ—Ç–∞–ª—å–Ω–æ–µ –¢–ó –¥–ª—è –∞–≤—Ç–æ—Ä–∞.

–§–û–†–ú–ê–¢ –û–¢–í–ï–¢–ê (—Å—Ç—Ä–æ–≥–æ JSON):
{
  "h1": "–ì–ª–∞–≤–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ (—Ç–æ—á–Ω–æ –∫–∞–∫ –≤ –∏–¥–µ–µ)",
  "title": "SEO-title –¥–æ 60 —Å–∏–º–≤–æ–ª–æ–≤",
  "description": "Meta description –¥–æ 160 —Å–∏–º–≤–æ–ª–æ–≤",
  "outline": [
    {
      "level": "h2",
      "heading": "–ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å–µ–∫—Ü–∏–∏",
      "content": "–ö—Ä–∞—Ç–∫–∏–µ —Ç–µ–∑–∏—Å—ã (3-5 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π)",
      "subsections": [
        {
          "level": "h3",
          "heading": "–ü–æ–¥—Å–µ–∫—Ü–∏—è",
          "content": "–¢–µ–∑–∏—Å—ã"
        }
      ]
    }
  ],
  "faq": [
    {
      "question": "–ü–æ–ø—É–ª—è—Ä–Ω—ã–π –≤–æ–ø—Ä–æ—Å?",
      "answer": "–†–∞–∑–≤–µ—Ä–Ω—É—Ç—ã–π –æ—Ç–≤–µ—Ç 3-5 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π"
    }
  ],
  "schema": {
    "@context": "https://schema.org",
    "@type": "${idea.schema || 'Article'}",
    "headline": "–ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç–∞—Ç—å–∏",
    "description": "–û–ø–∏—Å–∞–Ω–∏–µ",
    "author": {
      "@type": "Organization",
      "name": "O'KEY ENGLISH"
    },
    "publisher": {
      "@type": "Organization",
      "name": "O'KEY ENGLISH",
      "logo": {
        "@type": "ImageObject",
        "url": "https://okeyenglish.ru/logo.png"
      }
    }
  },
  "internalLinks": [
    {
      "anchor": "–∞–Ω–∫–æ—Ä —Ç–µ–∫—Å—Ç",
      "url": "/—Ä–µ–∞–ª—å–Ω—ã–π-–ø—É—Ç—å",
      "context": "–≤ –∫–∞–∫–æ–π —Å–µ–∫—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å"
    }
  ],
  "localInfo": ${idea.branch ? `{
    "address": "–ü–æ–ª–Ω—ã–π –∞–¥—Ä–µ—Å —Ñ–∏–ª–∏–∞–ª–∞",
    "metro": "–ú–µ—Ç—Ä–æ",
    "workingHours": "–ü–Ω-–ü—Ç 9:00-21:00",
    "features": ["–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å 1", "–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å 2"],
    "phone": "+7 (499) 707-35-35"
  }` : 'null'},
  "minWords": 1500,
  "callToAction": "–ó–∞–ø–∏—à–∏—Ç–µ—Å—å –Ω–∞ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø—Ä–æ–±–Ω—ã–π —É—Ä–æ–∫",
  "media": [
    {
      "type": "table" | "list" | "image",
      "caption": "–û–ø–∏—Å–∞–Ω–∏–µ",
      "placement": "–ø–æ—Å–ª–µ —Å–µ–∫—Ü–∏–∏ H2..."
    }
  ]
}

–¢–†–ï–ë–û–í–ê–ù–ò–Ø:
- –û–±—ä–µ–º outline: –º–∏–Ω–∏–º—É–º 5 H2-—Å–µ–∫—Ü–∏–π
- FAQ: 7-10 –≤–æ–ø—Ä–æ—Å–æ–≤
- –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Å—Å—ã–ª–∫–∏: 5-7 —à—Ç—É–∫, –æ—Ä–≥–∞–Ω–∏—á–Ω–æ –≤ —Ç–µ–∫—Å—Ç–µ
- –î–ª—è –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü: –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –±–ª–æ–∫ —Å –∫–æ–Ω—Ç–∞–∫—Ç–∞–º–∏ —Ñ–∏–ª–∏–∞–ª–∞
- –£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å: –ù–ï –∫–æ–ø–∏—Ä—É–π —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–æ—Ö–æ–∂–µ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- –¢–æ–Ω: —ç–∫—Å–ø–µ—Ä—Ç–Ω—ã–π, –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–π, –ø—Ä–æ—Å—Ç–æ–π
- –£–ø–æ–º–∏–Ω–∞–π –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ O'KEY: Cambridge, –ª–∏—Ü–µ–Ω–∑–∏—è, –º–∞—Ç–µ—Ä–∏–Ω—Å–∫–∏–π –∫–∞–ø–∏—Ç–∞–ª

–û—Ç–≤–µ—Ç –¢–û–õ–¨–ö–û JSON, –±–µ–∑ –æ–±–µ—Ä—Ç–∫–∏.
`;

/**
 * –ü—Ä–æ–º–ø—Ç –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ HTML-–∫–æ–Ω—Ç–µ–Ω—Ç–∞
 */
export const SCHOOL_ARTICLE_PROMPT = (brief: any) => `
–¢—ã ‚Äî –∞–≤—Ç–æ—Ä –∫–æ–Ω—Ç–µ–Ω—Ç–∞ —à–∫–æ–ª—ã –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ O'KEY ENGLISH.

–¢–ó:
${JSON.stringify(brief, null, 2)}

–ó–ê–î–ê–ß–ê: –ù–∞–ø–∏—à–∏ HTML-—Ñ—Ä–∞–≥–º–µ–Ω—Ç —Å—Ç–∞—Ç—å–∏ (–¢–û–õ–¨–ö–û —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ, –±–µ–∑ <html>, <head>, <body>).

–¢–†–ï–ë–û–í–ê–ù–ò–Ø:
- H1 –æ–¥–∏–Ω —Ä–∞–∑ –≤ —Å–∞–º–æ–º –Ω–∞—á–∞–ª–µ
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å—Ç—Ä–æ–≥–æ –ø–æ outline
- –û–±—ä–µ–º: –Ω–µ –º–µ–Ω–µ–µ ${brief.minWords || 1500} —Å–ª–æ–≤
- –ê–±–∑–∞—Ü—ã –ø–æ 3-5 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π
- –°–ø–∏—Å–∫–∏ (ul/ol) –≥–¥–µ —É–º–µ—Å—Ç–Ω–æ
- –¢–∞–±–ª–∏—Ü—ã –µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω—ã –≤ media
- –ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Å—Ç–∏–ª—å, –ë–ï–ó –≤–æ–¥—ã –∏ –∫–ª–∏–∫–±–µ–π—Ç–∞
- –ö–ª—é—á–µ–≤—ã–µ —Ñ—Ä–∞–∑—ã –æ—Ä–≥–∞–Ω–∏—á–Ω–æ, –ë–ï–ó –ø–µ—Ä–µ—Å–ø–∞–º–∞
- FAQ –≤ –∫–æ–Ω—Ü–µ —Å schema.org —Ä–∞–∑–º–µ—Ç–∫–æ–π
- –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Å—Å—ã–ª–∫–∏ –∏–∑ brief.internalLinks –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ –≤ —Ç–µ–∫—Å—Ç–µ
- CTA-–±–ª–æ–∫ –≤ –∫–æ–Ω—Ü–µ

${brief.localInfo ? `
–õ–û–ö–ê–õ–¨–ù–ê–Ø –°–¢–†–ê–ù–ò–¶–ê - –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û:
- –ë–ª–æ–∫ "–ö–∞–∫ –¥–æ–±—Ä–∞—Ç—å—Å—è" —Å –∞–¥—Ä–µ—Å–æ–º –∏ –º–µ—Ç—Ä–æ
- –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–±–æ—Ç—ã —Ñ–∏–ª–∏–∞–ª–∞
- –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∏–º–µ–Ω–Ω–æ —ç—Ç–æ–≥–æ —Ñ–∏–ª–∏–∞–ª–∞
- –£–ø–æ–º–∏–Ω–∞–Ω–∏–µ —Ä–∞–π–æ–Ω–∞/–ª–æ–∫–∞—Ü–∏–∏ 2-3 —Ä–∞–∑–∞
- –°—Å—ã–ª–∫–∏ –Ω–∞ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∏ –∫–æ–Ω—Ç–∞–∫—Ç—ã —Ñ–∏–ª–∏–∞–ª–∞
` : ''}

–°–¢–†–£–ö–¢–£–†–ê:
<article class="seo-content">
  <h1>${brief.h1}</h1>
  
  <div class="intro">
    <p>–í–≤–æ–¥–Ω—ã–π –∞–±–∑–∞—Ü —Å –∫–ª—é—á–µ–≤—ã–º –∑–∞–ø—Ä–æ—Å–æ–º. –ó–∞—Ü–µ–ø–∫–∞ –¥–ª—è —á–∏—Ç–∞—Ç–µ–ª—è. –û–±–µ—â–∞–Ω–∏–µ –ø–æ–ª—å–∑—ã –æ—Ç —Å—Ç–∞—Ç—å–∏.</p>
  </div>
  
  ${brief.outline.map((section: any, idx: number) => `
  <section class="content-section">
    <h2>${section.heading}</h2>
    <p>${section.content}</p>
    
    <p>–†–∞–∑–≤–µ—Ä–Ω–∏ —Ç–µ–∑–∏—Å—ã –≤ 2-3 –∞–±–∑–∞—Ü–∞. –î–æ–±–∞–≤—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –∏–∑ –ø—Ä–∞–∫—Ç–∏–∫–∏ O'KEY ENGLISH. 
    –ò—Å–ø–æ–ª—å–∑—É–π —Ü–∏—Ñ—Ä—ã, —Ñ–∞–∫—Ç—ã, —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å—Ç—É–¥–µ–Ω—Ç–æ–≤. –ü–∏—à–∏ –ø–æ–Ω—è—Ç–Ω–æ –¥–ª—è —Ä–æ–¥–∏—Ç–µ–ª–µ–π.</p>
    
    ${section.subsections?.map((sub: any) => `
    <h3>${sub.heading}</h3>
    <p>${sub.content}</p>
    
    <p>–†–∞–∑–≤–µ—Ä–Ω–∏ –ø–æ–¥—Å–µ–∫—Ü–∏—é. –î–æ–±–∞–≤—å —Å–ø–∏—Å–∫–∏ –∏–ª–∏ –ø—Ä–∏–º–µ—Ä—ã:</p>
    <ul>
      <li>–ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø—É–Ω–∫—Ç 1</li>
      <li>–ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø—É–Ω–∫—Ç 2</li>
      <li>–ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø—É–Ω–∫—Ç 3</li>
    </ul>
    `).join('') || ''}
    
    ${idx === 2 && brief.internalLinks.length > 0 ? `
    <p>–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º —Ç–∞–∫–∂–µ –æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å <a href="${brief.internalLinks[0].url}">${brief.internalLinks[0].anchor}</a>, 
    –≥–¥–µ –º—ã –ø–æ–¥—Ä–æ–±–Ω–æ —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞–µ–º –æ –ø—Ä–æ–≥—Ä–∞–º–º–∞—Ö –æ–±—É—á–µ–Ω–∏—è.</p>
    ` : ''}
  </section>
  `).join('\n')}
  
  ${brief.localInfo ? `
  <section class="local-info">
    <h2>–ö–∞–∫ –¥–æ–±—Ä–∞—Ç—å—Å—è –≤ –Ω–∞—à —Ñ–∏–ª–∏–∞–ª</h2>
    <div class="info-block">
      <p><strong>üìç –ê–¥—Ä–µ—Å:</strong> ${brief.localInfo.address}</p>
      <p><strong>üöá –ú–µ—Ç—Ä–æ:</strong> ${brief.localInfo.metro}</p>
      <p><strong>üïê –†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã:</strong> ${brief.localInfo.workingHours}</p>
      <p><strong>üìû –¢–µ–ª–µ—Ñ–æ–Ω:</strong> ${brief.localInfo.phone}</p>
    </div>
    
    <p>–ù–∞—à —Ñ–∏–ª–∏–∞–ª —É–¥–æ–±–Ω–æ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω —Ä—è–¥–æ–º —Å –º–µ—Ç—Ä–æ. –ú—ã —Ä–∞–±–æ—Ç–∞–µ–º –¥–ª—è –≤–∞—Å –∫–∞–∂–¥—ã–π –¥–µ–Ω—å, 
    –ø—Ä–µ–¥–ª–∞–≥–∞—è –≥–∏–±–∫–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è –¥–µ—Ç–µ–π –∏ –≤–∑—Ä–æ—Å–ª—ã—Ö. –ü–µ—Ä–≤–æ–µ –∑–∞–Ω—è—Ç–∏–µ ‚Äî –±–µ—Å–ø–ª–∞—Ç–Ω–æ!</p>
    
    ${brief.localInfo.features ? `
    <h3>–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ñ–∏–ª–∏–∞–ª–∞</h3>
    <ul>
      ${brief.localInfo.features.map((f: string) => `<li>${f}</li>`).join('\n      ')}
    </ul>
    ` : ''}
  </section>
  ` : ''}
  
  <section class="faq" itemscope itemtype="https://schema.org/FAQPage">
    <h2>–ß–∞—Å—Ç–æ –∑–∞–¥–∞–≤–∞–µ–º—ã–µ –≤–æ–ø—Ä–æ—Å—ã</h2>
    
    ${brief.faq.map((item: any) => `
    <div class="faq-item" itemscope itemprop="mainEntity" itemtype="https://schema.org/Question">
      <h3 itemprop="name">${item.question}</h3>
      <div itemscope itemprop="acceptedAnswer" itemtype="https://schema.org/Answer">
        <p itemprop="text">${item.answer}</p>
      </div>
    </div>
    `).join('\n    ')}
  </section>
  
  <div class="cta-block">
    <h2>${brief.callToAction}</h2>
    <p>–ù–µ —É–ø—É—Å—Ç–∏—Ç–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –Ω–∞—á–∞—Ç—å –æ–±—É—á–µ–Ω–∏–µ –≤ –æ–¥–Ω–æ–π –∏–∑ –ª—É—á—à–∏—Ö —à–∫–æ–ª –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ —è–∑—ã–∫–∞. 
    –ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –ö–µ–º–±—Ä–∏–¥–∂—Å–∫–∏–µ —É—á–µ–±–Ω–∏–∫–∏, –∏–º–µ–µ–º –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—É—é –ª–∏—Ü–µ–Ω–∑–∏—é, 
    –∏ –≤—ã –º–æ–∂–µ—Ç–µ –æ–ø–ª–∞—Ç–∏—Ç—å –æ–±—É—á–µ–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–Ω—Å–∫–∏–º –∫–∞–ø–∏—Ç–∞–ª–æ–º.</p>
    
    <div class="cta-buttons">
      <a href="/contacts" class="btn btn-primary">–ó–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –ø—Ä–æ–±–Ω—ã–π —É—Ä–æ–∫</a>
      <a href="tel:+74997073535" class="btn btn-secondary">–ü–æ–∑–≤–æ–Ω–∏—Ç—å: +7 (499) 707-35-35</a>
    </div>
    
    ${brief.internalLinks.length > 1 ? `
    <p class="additional-links">
      –¢–∞–∫–∂–µ —á–∏—Ç–∞–π—Ç–µ: 
      ${brief.internalLinks.slice(1, 4).map((link: any) => 
        `<a href="${link.url}">${link.anchor}</a>`
      ).join(', ')}
    </p>
    ` : ''}
  </div>
</article>

–°–¢–ò–õ–¨:
- –ü–∏—à–∏ –∫–∞–∫ –æ–ø—ã—Ç–Ω—ã–π –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å, –∫–æ—Ç–æ—Ä—ã–π –æ–±—ä—è—Å–Ω—è–µ—Ç —Ä–æ–¥–∏—Ç–µ–ª—è–º
- –ò—Å–ø–æ–ª—å–∑—É–π –ø—Ä–∏–º–µ—Ä—ã –∏–∑ –ø—Ä–∞–∫—Ç–∏–∫–∏ O'KEY ENGLISH
- –£–ø–æ–º–∏–Ω–∞–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã: Super Safari, Kid's Box, Prepare, Empower
- –£–ø–æ–º–∏–Ω–∞–π –º–µ—Ç–æ–¥–∏–∫—É (–∫–æ–º–º—É–Ω–∏–∫–∞—Ç–∏–≤–Ω–∞—è, Cambridge)
- –ò–∑–±–µ–≥–∞–π –æ–±—â–∏—Ö —Ñ—Ä–∞–∑ —Ç–∏–ø–∞ "–∫–∞–∫ –∏–∑–≤–µ—Å—Ç–Ω–æ", "–≤ –Ω–∞—à–µ –≤—Ä–µ–º—è"
- –ö–æ–Ω–∫—Ä–µ—Ç–∏–∫–∞: —Ü–∏—Ñ—Ä—ã, —Ñ–∞–∫—Ç—ã, —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
- –î—Ä—É–∂–µ–ª—é–±–Ω—ã–π —Ç–æ–Ω, –Ω–æ —ç–∫—Å–ø–µ—Ä—Ç–Ω—ã–π
- –ê–±–∑–∞—Ü—ã 3-5 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ —á—Ç–µ–Ω–∏—è

–í–ê–ñ–ù–û:
- –ù–ï –∏—Å–ø–æ–ª—å–∑—É–π markdown
- –ß–∏—Å—Ç—ã–π HTML –±–µ–∑ –∫–ª–∞—Å—Å–æ–≤ –∫—Ä–æ–º–µ —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏—Ö
- –í—Å–µ —Å—Å—ã–ª–∫–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤–∞–ª–∏–¥–Ω—ã–º–∏ (–∏–∑ brief.internalLinks)
- FAQ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å –º–∏–∫—Ä–æ—Ä–∞–∑–º–µ—Ç–∫–æ–π schema.org
- CTA –≤ –∫–æ–Ω—Ü–µ –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω

–û—Ç–≤–µ—Ç –¢–û–õ–¨–ö–û HTML-–∫–æ–¥ —Å—Ç–∞—Ç—å–∏, –±–µ–∑ –æ–±–µ—Ä—Ç–∫–∏ \`\`\`html.
`;

/**
 * –ü—Ä–æ–º–ø—Ç –¥–ª—è —Ä–µ–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Å–ª–∞–±—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü
 */
export const REOPTIMIZE_PROMPT = (
  originalBrief: any,
  currentMetrics: any,
  feedback: string[]
) => `
–¢—ã ‚Äî SEO-—Ä–µ–¥–∞–∫—Ç–æ—Ä —à–∫–æ–ª—ã –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ O'KEY ENGLISH.

–ò–°–•–û–î–ù–û–ï –¢–ó:
${JSON.stringify(originalBrief, null, 2)}

–¢–ï–ö–£–©–ò–ï –ú–ï–¢–†–ò–ö–ò:
- –°—Ä–µ–¥–Ω—è—è –ø–æ–∑–∏—Ü–∏—è: ${currentMetrics.avg_position}
- CTR: ${currentMetrics.ctr}%
- –ü–æ–∫–∞–∑–∞—Ç–µ–ª—å –æ—Ç–∫–∞–∑–æ–≤: ${currentMetrics.bounce_rate}%
- –í—Ä–µ–º—è –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ: ${currentMetrics.time_on_page}—Å

–ü–†–û–ë–õ–ï–ú–´:
${feedback.join('\n')}

–ó–ê–î–ê–ß–ê: –£–ª—É—á—à–∏ –¢–ó –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π.

–°–¢–†–ê–¢–ï–ì–ò–ò –£–õ–£–ß–®–ï–ù–ò–Ø:
1. **–ù–∏–∑–∫–∞—è –ø–æ–∑–∏—Ü–∏—è (>15)**: –î–æ–±–∞–≤—å –±–æ–ª—å—à–µ –∫–ª—é—á–µ–≤—ã—Ö —Ñ—Ä–∞–∑, —Ä–∞—Å—à–∏—Ä—å –∫–æ–Ω—Ç–µ–Ω—Ç, —É–ª—É—á—à–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É
2. **–ù–∏–∑–∫–∏–π CTR (<2%)**: –£–ª—É—á—à–∏ title –∏ description, —Å–¥–µ–ª–∞–π –∏—Ö –±–æ–ª–µ–µ –ø—Ä–∏–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–º–∏
3. **–í—ã—Å–æ–∫–∏–π –æ—Ç–∫–∞–∑ (>60%)**: –î–æ–±–∞–≤—å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–∞, —É–ª—É—á—à–∏ –ø–µ—Ä–≤—ã–π —ç–∫—Ä–∞–Ω, —É—Å–∏–ª—å CTA
4. **–ú–∞–ª–æ –≤—Ä–µ–º–µ–Ω–∏ (<60—Å)**: –î–æ–±–∞–≤—å –ø—Ä–∏–º–µ—Ä—ã, –∫–µ–π—Å—ã, —Ç–∞–±–ª–∏—Ü—ã, —Ä–∞—Å—à–∏—Ä—å FAQ

–ö–û–ù–ö–†–ï–¢–ù–´–ï –£–õ–£–ß–®–ï–ù–ò–Ø:
- –î–æ–±–∞–≤—å 2-3 –Ω–æ–≤—ã–µ H2-—Å–µ–∫—Ü–∏–∏ —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏
- –†–∞—Å—à–∏—Ä—å FAQ –¥–æ 10-12 –≤–æ–ø—Ä–æ—Å–æ–≤
- –î–æ–±–∞–≤—å —Å—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—É—é —Ç–∞–±–ª–∏—Ü—É (–µ—Å–ª–∏ —É–º–µ—Å—Ç–Ω–æ)
- –£—Å–∏–ª—å –ø–µ—Ä–≤—ã–π –∞–±–∑–∞—Ü (–∑–∞—Ü–µ–ø–∫–∞ + –ø–æ–ª—å–∑–∞)
- –î–æ–±–∞–≤—å 3-5 –Ω–æ–≤—ã—Ö –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö —Å—Å—ã–ª–æ–∫
- –í–∫–ª—é—á–∏ –±–æ–ª—å—à–µ —Ü–∏—Ñ—Ä –∏ –∫–æ–Ω–∫—Ä–µ—Ç–∏–∫–∏
- –î–æ–±–∞–≤—å —Ä–µ–∞–ª—å–Ω—ã–µ –æ—Ç–∑—ã–≤—ã/–∫–µ–π—Å—ã —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ O'KEY

–§–û–†–ú–ê–¢: –í–µ—Ä–Ω–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π JSON brief –≤ —Ç–æ–º –∂–µ —Ñ–æ—Ä–º–∞—Ç–µ, —á—Ç–æ –∏ –∏—Å—Ö–æ–¥–Ω—ã–π.

–û—Ç–≤–µ—Ç –¢–û–õ–¨–ö–û JSON, –±–µ–∑ –æ–±–µ—Ä—Ç–∫–∏.
`;

/**
 * –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ñ–∏–ª–∏–∞–ª–µ
 */
export function getBranchInfo(branchId: string) {
  const branch = branches.find(b => b.id === branchId);
  if (!branch) return null;
  
  return {
    name: branch.name,
    address: branch.address,
    metro: branch.metro,
    phone: '+7 (499) 707-35-35',
    workingHours: '–ü–Ω-–ü—Ç 9:00-21:00, –°–±-–í—Å 10:00-18:00',
    features: [
      '–õ–∏—Ü–µ–Ω–∑–∏—è –Ω–∞ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—É—é –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å',
      '–ö–µ–º–±—Ä–∏–¥–∂—Å–∫–∏–µ —É—á–µ–±–Ω–∏–∫–∏',
      '–û–ø–ª–∞—Ç–∞ –º–∞—Ç–µ—Ä–∏–Ω—Å–∫–∏–º –∫–∞–ø–∏—Ç–∞–ª–æ–º',
      '–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø—Ä–æ–±–Ω—ã–π —É—Ä–æ–∫',
      '–ù–µ–±–æ–ª—å—à–∏–µ –≥—Ä—É–ø–ø—ã –¥–æ 8 —á–µ–ª–æ–≤–µ–∫'
    ]
  };
}
