
# Проверка дублей при переводе клиента в преподавателя

## Проблема
Сейчас при переводе клиента в преподавателя система молча привязывает к существующему преподавателю по номеру телефона без подтверждения пользователя. Нет возможности вручную выбрать преподавателя для склеивания.

## Что будет сделано

Обновить `ConvertToTeacherModal` -- добавить промежуточный шаг:

1. При открытии модалки, если найден преподаватель с совпадающим телефоном -- показать предупреждение с данными найденного преподавателя и предложить:
   - **"Склеить с существующим"** -- перенести сообщения на найденного преподавателя
   - **"Создать нового"** -- создать отдельного преподавателя
   - **"Выбрать другого"** -- открыть поиск/список преподавателей для ручного выбора

2. Добавить возможность поиска преподавателя по имени/телефону для ручной склейки (выпадающий список с поиском)

## Технические детали

### Файл: `src/components/crm/ConvertToTeacherModal.tsx`

**Новое состояние:**
- `matchedTeacher` -- найденный преподаватель по телефону (или null)
- `selectedTeacher` -- выбранный вручную преподаватель для склейки
- `mode`: `'check'` | `'form'` | `'select'` -- текущий шаг UI
- `teacherSearch` -- строка поиска для списка преподавателей

**Логика:**
1. При открытии -- запрос к `teachers` по нормализованному телефону (10 последних цифр), сохраняем в `matchedTeacher`
2. Если найден -- показать карточку: "Найден преподаватель: Иванов Иван (+7...)" с кнопками выбора
3. При выборе "Выбрать другого" -- показать поле поиска + список преподавателей из хука `useTeachers`
4. При подтверждении -- вызвать существующую логику `handleConvert` с `teacherId` из выбранного преподавателя

**UI изменения:**
- Шаг 1 (mode='check'): Карточка найденного преподавателя + 3 кнопки
- Шаг 2a (mode='form'): Текущая форма создания нового (без изменений)
- Шаг 2b (mode='select'): Поле поиска + список преподавателей с кликом для выбора
