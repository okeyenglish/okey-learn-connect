
## Контекстные клише (Smart Replies) для чатов CRM

### Суть
Когда последнее входящее сообщение от клиента/преподавателя содержит "благодарственную" или другую типовую фразу, над полем ввода появляется панель с быстрыми ответами-клише. Менеджер может нажать на кнопку и мгновенно отправить ответ.

### Категории триггеров и клише

**1. Благодарность** (триггеры: "спасибо", "благодарю", "спс", "thanks")
- "Всегда рады помочь!"
- "Обращайтесь, если будут вопросы!"
- "Рады были помочь! Хорошего дня!"

**2. Приветствие** (триггеры: "здравствуйте", "добрый день", "привет", "hello")
- "Здравствуйте! Чем могу помочь?"
- "Добрый день! Слушаю вас"
- "Здравствуйте! Рады вас слышать!"

**3. Прощание** (триггеры: "до свидания", "пока", "всего доброго", "хорошего дня")
- "До свидания! Хорошего дня!"
- "Всего доброго! Обращайтесь!"
- "До встречи! Будем рады помочь снова"

**4. Согласие / Подтверждение** (триггеры: "хорошо", "ок", "понял", "ладно", "договорились")
- "Отлично, договорились!"
- "Если будут вопросы - пишите!"
- "Рады, что смогли помочь!"

**5. Извинение** (триггеры: "извините", "простите", "сорри", "прошу прощения")
- "Ничего страшного!"
- "Всё в порядке, не переживайте!"
- "Без проблем!"

### Техническая реализация

#### 1. Новый компонент `SmartReplySuggestions`
**Файл:** `src/components/crm/SmartReplySuggestions.tsx`

- Принимает текст последнего входящего сообщения
- Анализирует его на наличие ключевых слов (простой regex-матчинг, без AI)
- Отображает горизонтальную полоску с кнопками-клише над полем ввода
- При нажатии -- вызывает колбэк `onSend(text)` для мгновенной отправки
- Анимация появления (fade-in) для плавного UX
- Скрывается автоматически, если менеджер начал печатать своё сообщение

#### 2. Интеграция в `ChatArea.tsx`
- Добавить компонент `SmartReplySuggestions` между областью сообщений и полем ввода
- Передавать текст последнего входящего сообщения (уже есть `lastMessage` и `isLastMessageIncoming`)
- При выборе клише -- вызывать существующий `handleSendMessage` с подставленным текстом
- Скрывать панель, если поле ввода не пустое (`message.trim()`)

#### 3. Хук `useSmartReplies`
**Файл:** `src/hooks/useSmartReplies.ts`

- Содержит словарь триггеров и ответов
- Функция `detectCategory(messageText)` -- определяет категорию по ключевым словам
- Функция `getSuggestions(messageText)` -- возвращает массив клише
- Чисто клиентская логика, без запросов к БД (быстро и надёжно)
- В будущем можно расширить для загрузки кастомных клише из БД

#### 4. Интеграция в чаты преподавателей
- Аналогичная интеграция в `CorporateChatArea.tsx` (чаты преподавателей)
- Тот же компонент `SmartReplySuggestions`

### UX-поведение
- Панель появляется только когда последнее сообщение входящее И содержит триггерную фразу
- Панель скрывается если менеджер начал набирать текст
- После отправки клише панель исчезает
- Кнопки стилизованы как compact pill-buttons (аналогично `QuickReplySuggestions`)
- На мобильных -- кнопки переносятся на вторую строку при нехватке места
